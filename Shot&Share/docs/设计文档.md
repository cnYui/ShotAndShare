# Shot&Share 小程序设计文档

## 一、界面设计与页面结构

### 1.1 页面架构

#### 主要页面：
1. **首页（index）** - 主要功能入口
2. **文案生成页（generate）** - 核心功能页面
3. **个人中心页（profile）** - 用户信息和历史记录
4. **历史记录页（history）** - 查看生成的文案历史
5. **预览分享页（preview）** - 预览和分享生成的内容

### 1.2 页面功能详细设计

#### 1.2.1 首页（index）
**功能：**
- 展示小程序介绍和主要功能
- 快速开始按钮，跳转到文案生成页
- 最近生成的文案预览（3-5条）
- 底部导航栏

**界面元素：**
- 顶部Logo和标题
- 功能介绍卡片
- "开始创作"按钮
- 最近作品展示区域
- 底部Tab导航

#### 1.2.2 文案生成页（generate）
**功能：**
- 图片上传功能
- 文字描述输入框
- 文案风格选择器
- 生成文案按钮
- 生成结果展示
- 保存和分享功能

**界面元素：**
- 图片上传区域（支持拍照/相册选择）
- 文字描述输入框（多行文本）
- 风格选择标签组（8种风格）
- "生成文案"按钮
- 文案结果列表（3-5条）
- 每条文案的操作按钮（选择、编辑、分享）

#### 1.2.3 个人中心页（profile）
**功能：**
- 用户基本信息展示
- 生成统计数据
- 历史记录入口
- 设置选项

**界面元素：**
- 用户头像和昵称
- 统计卡片（总生成数、收藏数等）
- 功能入口列表
- 设置选项

#### 1.2.4 历史记录页（history）
**功能：**
- 展示所有历史生成的文案
- 搜索和筛选功能
- 重新编辑和分享
- 删除功能

**界面元素：**
- 搜索框
- 筛选标签（按风格、时间）
- 文案卡片列表
- 操作按钮（编辑、分享、删除）

#### 1.2.5 预览分享页（preview）
**功能：**
- 文案和图片合成预览
- 多种布局模板选择
- 保存到相册
- 分享功能

**界面元素：**
- 合成图片预览区
- 布局模板选择器
- 保存按钮
- 分享按钮

### 1.3 设计风格规范

**色彩方案：**
- 主色调：黑白灰
- 强调色：#2C2C2C（深灰）
- 背景色：#FAFAFA（浅灰白）
- 文字色：#333333（深灰）、#666666（中灰）、#999999（浅灰）

**字体规范：**
- 标题：16px-20px，加粗
- 正文：14px，常规
- 辅助文字：12px，细体

**间距规范：**
- 页面边距：32rpx
- 组件间距：24rpx
- 元素间距：16rpx

## 二、实现任务清单（按优先级排序）

### 优先级1：核心功能（必须实现）

#### 2.1 后端基础架构
- [ ] 1.1 微信云开发环境搭建
- [ ] 1.2 云函数基础框架搭建
- [ ] 1.3 数据库表结构设计和创建
- [ ] 1.4 用户认证和授权系统

#### 2.2 文案生成核心功能
- [ ] 2.1 文案生成API接口开发
- [ ] 2.2 图片识别功能集成
- [ ] 2.3 文案风格模板开发
- [ ] 2.4 文案生成算法优化

#### 2.3 前端核心页面
- [ ] 3.1 首页基础布局和功能
- [ ] 3.2 文案生成页面开发
- [ ] 3.3 图片上传功能实现
- [ ] 3.4 文案展示和选择功能

### 优先级2：基础功能（重要）

#### 2.4 用户系统
- [ ] 4.1 用户信息管理
- [ ] 4.2 文案历史保存功能
- [ ] 4.3 个人中心页面开发
- [ ] 4.4 历史记录页面开发

#### 2.5 分享功能
- [ ] 5.1 图片和文案合成功能
- [ ] 5.2 预览分享页面开发
- [ ] 5.3 保存到相册功能
- [ ] 5.4 分享功能实现

### 优先级3：增强功能（可选）

#### 2.6 个性化推荐
- [ ] 6.1 用户偏好分析
- [ ] 6.2 智能推荐算法
- [ ] 6.3 标签自动生成

#### 2.7 图片美化（低优先级）
- [ ] 7.1 滤镜效果开发
- [ ] 7.2 边框和贴纸功能
- [ ] 7.3 图片编辑工具

### 优先级4：优化功能（后期）

#### 2.8 性能优化
- [ ] 8.1 图片压缩和优化
- [ ] 8.2 缓存机制实现
- [ ] 8.3 加载性能优化

#### 2.9 用户体验优化
- [ ] 9.1 动画效果添加
- [ ] 9.2 交互反馈优化
- [ ] 9.3 错误处理完善

## 三、数据库表结构设计

### 3.1 用户表（users）
```javascript
{
  _id: ObjectId,           // 用户唯一标识
  openid: String,          // 微信用户openid
  unionid: String,         // 微信用户unionid（可选）
  nickname: String,        // 用户昵称
  avatar: String,          // 用户头像URL
  gender: Number,          // 性别（0-未知，1-男，2-女）
  city: String,            // 城市
  province: String,        // 省份
  country: String,         // 国家
  language: String,        // 语言
  preferences: {           // 用户偏好设置
    favoriteStyles: [String], // 偏好的文案风格
    defaultStyle: String,     // 默认文案风格
    autoSave: Boolean        // 是否自动保存
  },
  statistics: {            // 用户统计数据
    totalGenerated: Number,  // 总生成次数
    totalSaved: Number,      // 总保存次数
    totalShared: Number      // 总分享次数
  },
  createdAt: Date,         // 创建时间
  updatedAt: Date,         // 更新时间
  lastLoginAt: Date        // 最后登录时间
}
```

### 3.2 文案记录表（copywriting_records）
```javascript
{
  _id: ObjectId,           // 记录唯一标识
  userId: ObjectId,        // 用户ID（关联users表）
  imageUrl: String,        // 上传的图片URL
  imageInfo: {             // 图片信息
    width: Number,         // 图片宽度
    height: Number,        // 图片高度
    size: Number,          // 图片大小（字节）
    format: String         // 图片格式
  },
  userInput: {             // 用户输入信息
    description: String,   // 用户描述文字
    selectedStyle: String, // 选择的文案风格
    mood: String,          // 情感倾向
    scene: String          // 场景描述
  },
  imageAnalysis: {         // 图片分析结果
    tags: [String],        // 图片标签
    objects: [String],     // 识别的物体
    scene: String,         // 场景类型
    colors: [String],      // 主要颜色
    confidence: Number     // 识别置信度
  },
  generatedCopywriting: [{ // 生成的文案列表
    content: String,       // 文案内容
    style: String,         // 文案风格
    tags: [String],        // 自动生成的标签
    score: Number,         // 文案评分
    isSelected: Boolean    // 是否被用户选择
  }],
  selectedCopywriting: {   // 用户最终选择的文案
    content: String,       // 文案内容
    tags: [String],        // 标签
    customEdits: String    // 用户自定义编辑
  },
  compositeImage: {        // 合成图片信息
    url: String,           // 合成图片URL
    template: String,      // 使用的模板
    layout: String         // 布局方式
  },
  actions: {               // 用户操作记录
    isSaved: Boolean,      // 是否保存
    isShared: Boolean,     // 是否分享
    shareCount: Number,    // 分享次数
    viewCount: Number      // 查看次数
  },
  status: String,          // 记录状态（draft-草稿，completed-完成，deleted-已删除）
  createdAt: Date,         // 创建时间
  updatedAt: Date          // 更新时间
}
```

### 3.3 文案模板表（copywriting_templates）
```javascript
{
  _id: ObjectId,           // 模板唯一标识
  style: String,           // 文案风格
  category: String,        // 分类（场景、情感等）
  templates: [{            // 模板列表
    pattern: String,       // 文案模板模式
    variables: [String],   // 可替换变量
    examples: [String],    // 示例文案
    weight: Number         // 权重（用于随机选择）
  }],
  tags: [String],          // 相关标签
  isActive: Boolean,       // 是否启用
  createdAt: Date,         // 创建时间
  updatedAt: Date          // 更新时间
}
```

### 3.4 系统配置表（system_config）
```javascript
{
  _id: ObjectId,           // 配置唯一标识
  key: String,             // 配置键名
  value: Mixed,            // 配置值
  description: String,     // 配置描述
  category: String,        // 配置分类
  isActive: Boolean,       // 是否启用
  createdAt: Date,         // 创建时间
  updatedAt: Date          // 更新时间
}
```

### 3.5 用户反馈表（user_feedback）
```javascript
{
  _id: ObjectId,           // 反馈唯一标识
  userId: ObjectId,        // 用户ID
  recordId: ObjectId,      // 相关文案记录ID（可选）
  type: String,            // 反馈类型（like-喜欢，dislike-不喜欢，report-举报）
  content: String,         // 反馈内容
  rating: Number,          // 评分（1-5）
  status: String,          // 处理状态（pending-待处理，processed-已处理）
  createdAt: Date          // 创建时间
}
```

## 四、技术实现要点

### 4.1 微信云开发配置
- 使用微信云开发作为后端服务
- 云函数处理文案生成逻辑
- 云存储保存用户上传的图片
- 云数据库存储用户数据和文案记录

### 4.2 文案生成算法
- 结合图片识别结果和用户输入
- 基于模板和规则的文案生成
- 支持多种文案风格切换
- 个性化推荐机制

### 4.3 图片处理
- 图片上传和压缩
- 图片识别和标签提取
- 文案和图片合成
- 多种布局模板支持

### 4.4 性能优化
- 图片懒加载
- 数据缓存机制
- 分页加载历史记录
- 异步处理文案生成

## 五、开发时间规划

### 第一阶段（1-2周）：基础架构
- 微信云开发环境搭建
- 数据库设计和创建
- 基础页面框架搭建

### 第二阶段（2-3周）：核心功能
- 文案生成功能开发
- 图片上传和识别
- 用户系统实现

### 第三阶段（1-2周）：完善功能
- 历史记录和个人中心
- 分享和保存功能
- 界面优化和测试

### 第四阶段（1周）：优化和发布
- 性能优化
- 用户体验优化
- 测试和发布准备

总开发周期：5-8周