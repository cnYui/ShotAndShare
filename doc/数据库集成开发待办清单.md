
# å¥åº·å® ç‰©ä¼´ä¾£å°ç¨‹åº - æ•°æ®åº“é›†æˆå¼€å‘å¾…åŠæ¸…å•

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬å¾…åŠæ¸…å•æ—¨åœ¨å°†å½“å‰é™æ€æ•°æ®é©±åŠ¨çš„å°ç¨‹åºè½¬æ¢ä¸ºå®Œæ•´çš„æ•°æ®åº“é©±åŠ¨åº”ç”¨ï¼ŒåŒ…æ‹¬ç”¨æˆ·ç™»å½•ã€èŠå¤©å†å²ã€å¥åº·ä»»åŠ¡ç³»ç»Ÿå’Œå® ç‰©ç®¡ç†ç³»ç»Ÿçš„å®Œæ•´æ•°æ®åº“é›†æˆã€‚

---

## ğŸ” ç¬¬ä¸€é˜¶æ®µï¼šç™»å½•åŠŸèƒ½å®ç°

### 1.1 å‰ç«¯ç™»å½•é¡µé¢åˆ›å»º

**æ–‡ä»¶è·¯å¾„ï¼š** `/miniprogram/pages/login/`

#### åˆ›å»ºç™»å½•é¡µé¢æ–‡ä»¶
- [ ] **login.wxml** - ç™»å½•ç•Œé¢å¸ƒå±€
```xml
<view class="login-container">
  <view class="logo-section">
    <image src="/images/logo.png" class="logo"></image>
    <text class="app-name">å¥åº·å® ç‰©ä¼´ä¾£</text>
  </view>
  
  <view class="login-section">
    <button wx:if="{{!userInfo}}" 
            class="login-btn" 
            open-type="getUserProfile" 
            bindtap="onGetUserProfile">
      <image src="/images/wechat-icon.png" class="wechat-icon"></image>
      å¾®ä¿¡ç™»å½•
    </button>
    
    <view wx:else class="user-info">
      <image src="{{userInfo.avatarUrl}}" class="avatar"></image>
      <text class="nickname">{{userInfo.nickName}}</text>
      <button class="continue-btn" bindtap="onContinue">ç»§ç»­ä½¿ç”¨</button>
    </view>
  </view>
</view>
```

- [ ] **login.js** - ç™»å½•é€»è¾‘å®ç°
```javascript
Page({
  data: {
    userInfo: null,
    loading: false
  },

  onLoad() {
    this.checkLoginStatus();
  },

  // æ£€æŸ¥ç™»å½•çŠ¶æ€
  checkLoginStatus() {
    const userInfo = wx.getStorageSync('userInfo');
    if (userInfo) {
      this.setData({ userInfo });
    }
  },

  // è·å–ç”¨æˆ·ä¿¡æ¯å¹¶ç™»å½•
  onGetUserProfile() {
    wx.getUserProfile({
      desc: 'ç”¨äºå®Œå–„ç”¨æˆ·èµ„æ–™',
      success: (res) => {
        this.setData({ loading: true });
        this.loginWithUserInfo(res.userInfo);
      },
      fail: () => {
        wx.showToast({
          title: 'éœ€è¦æˆæƒæ‰èƒ½ä½¿ç”¨',
          icon: 'none'
        });
      }
    });
  },

  // è°ƒç”¨ç™»å½•äº‘å‡½æ•°
  async loginWithUserInfo(userInfo) {
    try {
      const result = await wx.cloud.callFunction({
        name: 'login',
        data: { userInfo }
      });

      if (result.result.success) {
        const userData = result.result.data;
        
        // ä¿å­˜ç”¨æˆ·ä¿¡æ¯
        wx.setStorageSync('userInfo', userData.user);
        wx.setStorageSync('petInfo', userData.pet);
        wx.setStorageSync('isLoggedIn', true);
        
        this.setData({ 
          userInfo: userData.user,
          loading: false 
        });
        
        wx.showToast({
          title: userData.isNewUser ? 'æ³¨å†ŒæˆåŠŸ' : 'ç™»å½•æˆåŠŸ',
          icon: 'success'
        });
        
        setTimeout(() => this.navigateBack(), 1500);
      } else {
        throw new Error(result.result.error);
      }
    } catch (error) {
      console.error('ç™»å½•å¤±è´¥:', error);
      this.setData({ loading: false });
      wx.showToast({
        title: 'ç™»å½•å¤±è´¥ï¼Œè¯·é‡è¯•',
        icon: 'none'
      });
    }
  },

  onContinue() {
    this.navigateBack();
  },

  navigateBack() {
    const pages = getCurrentPages();
    if (pages.length > 1) {
      wx.navigateBack();
    } else {
      wx.switchTab({ url: '/pages/index/index' });
    }
  }
});
```

- [ ] **login.wxss** - ç™»å½•é¡µé¢æ ·å¼

### 1.2 å…¨å±€ç™»å½•çŠ¶æ€ç®¡ç†

#### ä¿®æ”¹ app.js
- [ ] **æ·»åŠ å…¨å±€ç™»å½•æ£€æŸ¥**
```javascript
App({
  globalData: {
    env: "cloud1-6g4qsd2kcddd1be0",
    userInfo: null,
    petInfo: null,
    isLoggedIn: false
  },

  onLaunch() {
    this.initCloudBase();
    this.checkLoginStatus();
  },

  initCloudBase() {
    if (!wx.cloud) {
      console.error('è¯·ä½¿ç”¨ 2.2.3 æˆ–ä»¥ä¸Šçš„åŸºç¡€åº“ä»¥ä½¿ç”¨äº‘èƒ½åŠ›');
    } else {
      wx.cloud.init({
        env: this.globalData.env,
        traceUser: true,
      });
    }
  },

  async checkLoginStatus() {
    try {
      const result = await wx.cloud.callFunction({
        name: 'login'
      });

      if (result.result.success) {
        const userData = result.result.data;
        this.globalData.userInfo = userData.user;
        this.globalData.petInfo = userData.pet;
        this.globalData.isLoggedIn = true;
        
        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        wx.setStorageSync('userInfo', userData.user);
        wx.setStorageSync('petInfo', userData.pet);
        wx.setStorageSync('isLoggedIn', true);
      }
    } catch (error) {
      console.log('ç”¨æˆ·æœªç™»å½•æˆ–ç™»å½•æ£€æŸ¥å¤±è´¥');
      this.globalData.isLoggedIn = false;
    }
  },

  // å…¨å±€ç™»å½•æ–¹æ³•
  requireLogin() {
    if (!this.globalData.isLoggedIn) {
      wx.navigateTo({
        url: '/pages/login/login'
      });
      return false;
    }
    return true;
  }
});
```

### 1.3 é¡µé¢ç™»å½•æ£€æŸ¥é›†æˆ

#### ä¿®æ”¹èŠå¤©é¡µé¢
- [ ] **æ›´æ–° chat.js ç™»å½•æ£€æŸ¥**
```javascript
// åœ¨ onLoad æ–¹æ³•å¼€å§‹æ·»åŠ 
onLoad() {
  const app = getApp();
  if (!app.requireLogin()) {
    return;
  }
  
  this.initChat();
  this.loadChatHistory();
},

// ä¿®æ”¹ simulatePetReply æ–¹æ³•
simulateP etReply(userMessage) {
  this.setData({ isTyping: true });
  
  wx.cloud.callFunction({
    name: 'petChat',
    data: {
      message: userMessage
      // ç§»é™¤ç¡¬ç¼–ç çš„ petId
    },
    success: (res) => {
      this.setData({
        isTyping: false,
        isSending: false
      });
      
      if (res.result && res.result.success) {
        this.addMessage({
          type: 'pet',
          content: res.result.data.reply,
          time: this.formatTime(new Date()),
          liked: false
        });
        
        // æ›´æ–°å® ç‰©çŠ¶æ€
        const petStatus = res.result.data.pet_status;
        if (petStatus) {
          wx.setStorageSync('petInfo', petStatus);
        }
      } else {
        this.handleChatError(res.result.error);
      }
    },
    fail: (err) => {
      console.error('äº‘å‡½æ•°è°ƒç”¨å¤±è´¥:', err);
      this.handleChatError('ç½‘ç»œè¿æ¥å¤±è´¥');
    }
  });
},

handleChatError(errorMsg) {
  this.setData({
    isTyping: false,
    isSending: false
  });
  
  // ä½¿ç”¨æœ¬åœ°å›å¤ä½œä¸ºå¤‡é€‰
  const fallbackReply = this.generatePetReply(this.data.inputText);
  this.addMessage({
    type: 'pet',
    content: fallbackReply,
    time: this.formatTime(new Date()),
    liked: false
  });
  
  wx.showToast({
    title: errorMsg,
    icon: 'none'
  });
}
```

---

## ğŸ’¬ ç¬¬äºŒé˜¶æ®µï¼šèŠå¤©å†å²åŠŸèƒ½å®ç°

### 2.1 èŠå¤©å†å²åŠ è½½

#### ä¿®æ”¹ chat.js çš„ loadChatHistory æ–¹æ³•
- [ ] **å®ç°çœŸå®çš„èŠå¤©å†å²åŠ è½½**
```javascript
// åŠ è½½èŠå¤©å†å²
async loadChatHistory() {
  try {
    wx.showLoading({ title: 'åŠ è½½èŠå¤©è®°å½•...' });
    
    const result = await wx.cloud.callFunction({
      name: 'petChat',
      data: {
        action: 'getChatHistory',
        limit: 50 // æœ€è¿‘50æ¡æ¶ˆæ¯
      }
    });
    
    if (result.result.success) {
      const chatHistory = result.result.data.map(record => ({
        id: record._id,
        type: record.sender_type === 'user' ? 'user' : 'pet',
        content: record.message,
        time: this.formatTime(new Date(record.timestamp)),
        liked: false
      }));
      
      this.setData({ messages: chatHistory });
      this.scrollToBottom();
    }
  } catch (error) {
    console.error('åŠ è½½èŠå¤©å†å²å¤±è´¥:', error);
    // ä½¿ç”¨æœ¬åœ°ç¼“å­˜ä½œä¸ºå¤‡é€‰
    const localHistory = wx.getStorageSync('chatHistory') || [];
    this.setData({ messages: localHistory });
  } finally {
    wx.hideLoading();
  }
},

// ä¿å­˜èŠå¤©è®°å½•åˆ°æœ¬åœ°ï¼ˆå¤‡ç”¨ï¼‰
saveChatHistory() {
  wx.setStorageSync('chatHistory', this.data.messages);
},

// ä¿®æ”¹ addMessage æ–¹æ³•ï¼ŒåŒæ—¶ä¿å­˜åˆ°æœ¬åœ°
addMessage(message) {
  const messages = [...this.data.messages];
  message.id = Date.now() + Math.random();
  messages.push(message);
  
  this.setData({ messages });
  this.saveChatHistory();
  this.scrollToBottom();
}
```

### 2.2 æ‰©å±• petChat äº‘å‡½æ•°

#### ä¿®æ”¹ petChat/index.js
- [ ] **æ·»åŠ èŠå¤©å†å²æŸ¥è¯¢åŠŸèƒ½**
```javascript
exports.main = async (event, context) => {
  const wxContext = cloud.getWXContext();
  const openid = wxContext.OPENID;
  const { action, message, limit = 50 } = event;
  
  try {
    // å¤„ç†è·å–èŠå¤©å†å²çš„è¯·æ±‚
    if (action === 'getChatHistory') {
      return await getChatHistory(openid, limit);
    }
    
    // åŸæœ‰çš„èŠå¤©é€»è¾‘...
    return await handleChat(openid, message);
  } catch (error) {
    console.error('petChatäº‘å‡½æ•°æ‰§è¡Œå¤±è´¥:', error);
    return {
      success: false,
      error: error.message
    };
  }
};

// è·å–èŠå¤©å†å²
async function getChatHistory(openid, limit) {
  const chatHistory = await db.collection('chat_context')
    .where({ user_id: openid })
    .orderBy('timestamp', 'desc')
    .limit(limit)
    .get();
    
  return {
    success: true,
    data: chatHistory.data.reverse() // æŒ‰æ—¶é—´æ­£åºæ’åˆ—
  };
}

// å¤„ç†èŠå¤©æ¶ˆæ¯
async function handleChat(openid, message) {
  // è·å–ç”¨æˆ·å’Œå® ç‰©ä¿¡æ¯
  const userQuery = await db.collection('pet_users').where({
    user_id: openid
  }).get();
  
  const petQuery = await db.collection('pets').where({
    user_id: openid
  }).get();
  
  if (userQuery.data.length === 0 || petQuery.data.length === 0) {
    return {
      success: false,
      error: 'ç”¨æˆ·æˆ–å® ç‰©ä¿¡æ¯ä¸å­˜åœ¨ï¼Œè¯·å…ˆå®Œæˆç™»å½•'
    };
  }
  
  // åŸæœ‰çš„èŠå¤©å¤„ç†é€»è¾‘...
  // ...
}
```

---

## ğŸ“‹ ç¬¬ä¸‰é˜¶æ®µï¼šå¥åº·ä»»åŠ¡ç³»ç»Ÿæ•°æ®åº“é›†æˆ

### 3.1 ä»»åŠ¡é¡µé¢æ•°æ®åº“é›†æˆ

#### ä¿®æ”¹ tasks.js
- [ ] **æ›¿æ¢é™æ€æ•°æ®ä¸ºæ•°æ®åº“æŸ¥è¯¢**
```javascript
Page({
  data: {
    currentCategory: 'all',
    todayCompleted: 0,
    weeklyCompleted: 0,
    totalExp: 0,
    todayTasks: [],
    weeklyTasks: [],
    loading: true
  },

  onLoad() {
    const app = getApp();
    if (!app.requireLogin()) {
      return;
    }
    this.loadTaskData();
  },

  onShow() {
    // æ¯æ¬¡æ˜¾ç¤ºé¡µé¢æ—¶åˆ·æ–°æ•°æ®
    this.loadTaskData();
  },

  // åŠ è½½ä»»åŠ¡æ•°æ®
  async loadTaskData() {
    try {
      wx.showLoading({ title: 'åŠ è½½ä»»åŠ¡æ•°æ®...' });
      
      const result = await wx.cloud.callFunction({
        name: 'taskManager',
        data: {
          action: 'getUserTasks'
        }
      });
      
      if (result.result.success) {
        const data = result.result.data;
        this.setData({
          todayTasks: data.todayTasks,
          weeklyTasks: data.weeklyTasks,
          todayCompleted: data.todayCompleted,
          weeklyCompleted: data.weeklyCompleted,
          totalExp: data.totalExp,
          loading: false
        });
      } else {
        throw new Error(result.result.error);
      }
    } catch (error) {
      console.error('åŠ è½½ä»»åŠ¡æ•°æ®å¤±è´¥:', error);
      wx.showToast({
        title: 'åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•',
        icon: 'none'
      });
      this.setData({ loading: false });
    } finally {
      wx.hideLoading();
    }
  },

  // å®Œæˆä»»åŠ¡
  async completeTask(e) {
    const taskId = e.currentTarget.dataset.id;
    const taskType = e.currentTarget.dataset.type;
    
    try {
      wx.showLoading({ title: 'æäº¤ä»»åŠ¡...' });
      
      const result = await wx.cloud.callFunction({
        name: 'taskManager',
        data: {
          action: 'completeTask',
          taskId: taskId,
          taskType: taskType
        }
      });
      
      if (result.result.success) {
        const data = result.result.data;
        
        // æ˜¾ç¤ºå¥–åŠ±ä¿¡æ¯
        wx.showModal({
          title: 'ä»»åŠ¡å®Œæˆï¼',
          content: `è·å¾— ${data.expReward} ç»éªŒå€¼ï¼`,
          showCancel: false,
          confirmText: 'å¤ªæ£’äº†'
        });
        
        // åˆ·æ–°ä»»åŠ¡æ•°æ®
        this.loadTaskData();
        
        // æ›´æ–°å® ç‰©ä¿¡æ¯
        if (data.petStatus) {
          wx.setStorageSync('petInfo', data.petStatus);
        }
      } else {
        throw new Error(result.result.error);
      }
    } catch (error) {
      console.error('å®Œæˆä»»åŠ¡å¤±è´¥:', error);
      wx.showToast({
        title: 'æäº¤å¤±è´¥ï¼Œè¯·é‡è¯•',
        icon: 'none'
      });
    } finally {
      wx.hideLoading();
    }
  },

  // å¼€å§‹è®¡æ—¶ä»»åŠ¡
  async startTimerTask(e) {
    const taskId = e.currentTarget.dataset.id;
    
    // å®ç°è®¡æ—¶å™¨é€»è¾‘
    wx.showModal({
      title: 'å¼€å§‹ä»»åŠ¡',
      content: 'æ˜¯å¦å¼€å§‹è®¡æ—¶ä»»åŠ¡ï¼Ÿ',
      success: (res) => {
        if (res.confirm) {
          this.startTaskTimer(taskId);
        }
      }
    });
  },

  startTaskTimer(taskId) {
    // å®ç°å…·ä½“çš„è®¡æ—¶å™¨é€»è¾‘
    // å¯ä»¥è·³è½¬åˆ°ä¸“é—¨çš„è®¡æ—¶é¡µé¢
    wx.navigateTo({
      url: `/pages/timer/timer?taskId=${taskId}`
    });
  }
});
```

### 3.2 æ‰©å±• taskManager äº‘å‡½æ•°

#### ä¿®æ”¹ taskManager/index.js
- [ ] **å®ç°å®Œæ•´çš„ä»»åŠ¡ç®¡ç†åŠŸèƒ½**
```javascript
const cloud = require('wx-server-sdk');
cloud.init({ env: cloud.DYNAMIC_CURRENT_ENV });
const db = cloud.database();

exports.main = async (event, context) => {
  const wxContext = cloud.getWXContext();
  const openid = wxContext.OPENID;
  const { action, taskId, taskType, duration } = event;
  
  try {
    switch (action) {
      case 'getUserTasks':
        return await getUserTasks(openid);
      case 'completeTask':
        return await completeTask(openid, taskId, taskType, duration);
      case 'initDailyTasks':
        return await initDailyTasks(openid);
      default:
        return { success: false, error: 'æ— æ•ˆçš„æ“ä½œç±»å‹' };
    }
  } catch (error) {
    console.error('taskManageräº‘å‡½æ•°æ‰§è¡Œå¤±è´¥:', error);
    return {
      success: false,
      error: error.message
    };
  }
};

// è·å–ç”¨æˆ·ä»»åŠ¡
async function getUserTasks(openid) {
  const today = new Date().toISOString().split('T')[0];
  
  // è·å–ä»Šæ—¥ä»»åŠ¡è®°å½•
  const todayRecords = await db.collection('task_records')
    .where({
      user_id: openid,
      date: today
    })
    .get();
  
  // è·å–åŸºç¡€ä»»åŠ¡æ¨¡æ¿
  const taskTemplates = await db.collection('tasks').get();
  
  // ç”Ÿæˆä»Šæ—¥ä»»åŠ¡
  const todayTasks = taskTemplates.data
    .filter(task => task.type === 'daily')
    .map(task => {
      const record = todayRecords.data.find(r => r.task_id === task._id);
      return {
        ...task,
        completed: !!record,
        progress: record ? record.progress : 0
      };
    });
  
  // è·å–å‘¨ä»»åŠ¡
  const weekStart = getWeekStart();
  const weekRecords = await db.collection('task_records')
    .where({
      user_id: openid,
      date: db.command.gte(weekStart)
    })
    .get();
  
  const weeklyTasks = taskTemplates.data
    .filter(task => task.type === 'weekly')
    .map(task => {
      const records = weekRecords.data.filter(r => r.task_id === task._id);
      const totalProgress = records.reduce((sum, r) => sum + (r.progress || 0), 0);
      return {
        ...task,
        currentProgress: totalProgress,
        completed: totalProgress >= task.target_progress
      };
    });
  
  // è®¡ç®—ç»Ÿè®¡æ•°æ®
  const todayCompleted = todayTasks.filter(t => t.completed).length;
  const weeklyCompleted = weeklyTasks.filter(t => t.completed).length;
  
  // è·å–ç”¨æˆ·æ€»ç»éªŒ
  const userQuery = await db.collection('pet_users')
    .where({ user_id: openid })
    .get();
  const totalExp = userQuery.data[0]?.total_exp || 0;
  
  return {
    success: true,
    data: {
      todayTasks,
      weeklyTasks,
      todayCompleted,
      weeklyCompleted,
      totalExp
    }
  };
}

// å®Œæˆä»»åŠ¡
async function completeTask(openid, taskId, taskType, duration = 0) {
  const today = new Date().toISOString().split('T')[0];
  
  // è·å–ä»»åŠ¡ä¿¡æ¯
  const taskQuery = await db.collection('tasks').doc(taskId).get();
  if (!taskQuery.data) {
    throw new Error('ä»»åŠ¡ä¸å­˜åœ¨');
  }
  
  const task = taskQuery.data;
  
  // æ£€æŸ¥æ˜¯å¦å·²å®Œæˆ
  const existingRecord = await db.collection('task_records')
    .where({
      user_id: openid,
      task_id: taskId,
      date: today
    })
    .get();
  
  if (existingRecord.data.length > 0 && task.type === 'daily') {
    throw new Error('ä»Šæ—¥ä»»åŠ¡å·²å®Œæˆ');
  }
  
  // åˆ›å»ºä»»åŠ¡è®°å½•
  const progress = taskType === 'timer' ? duration : 1;
  await db.collection('task_records').add({
    data: {
      user_id: openid,
      task_id: taskId,
      date: today,
      progress: progress,
      completed_at: new Date(),
      exp_reward: task.reward
    }
  });
  
  // æ›´æ–°ç”¨æˆ·ç»éªŒ
  await db.collection('pet_users')
    .where({ user_id: openid })
    .update({
      data: {
        total_exp: db.command.inc(task.reward)
      }
    });
  
  // æ›´æ–°å® ç‰©ç»éªŒå’Œäº²å¯†åº¦
  const petUpdateResult = await db.collection('pets')
    .where({ user_id: openid })
    .update({
      data: {
        exp: db.command.inc(task.reward),
        intimacy: db.command.inc(Math.floor(task.reward / 5)),
        last_active: new Date()
      }
    });
  
  // æ£€æŸ¥å® ç‰©æ˜¯å¦å‡çº§
  const petQuery = await db.collection('pets')
    .where({ user_id: openid })
    .get();
  
  const pet = petQuery.data[0];
  const newLevel = Math.floor(pet.exp / 100) + 1;
  
  if (newLevel > pet.level) {
    await db.collection('pets')
      .doc(pet._id)
      .update({
        data: {
          level: newLevel,
          health: Math.min(pet.health + 10, 100),
          vitality: Math.min(pet.vitality + 10, 100)
        }
      });
  }
  
  // è¿”å›æ›´æ–°åçš„å® ç‰©çŠ¶æ€
  const updatedPet = await db.collection('pets')
    .where({ user_id: openid })
    .get();
  
  return {
    success: true,
    data: {
      expReward: task.reward,
      petStatus: updatedPet.data[0],
      levelUp: newLevel > pet.level
    }
  };
}

// è·å–æœ¬å‘¨å¼€å§‹æ—¥æœŸ
function getWeekStart() {
  const now = new Date();
  const dayOfWeek = now.getDay();
  const diff = now.getDate() - dayOfWeek;
  const weekStart = new Date(now.setDate(diff));
  return weekStart.toISOString().split('T')[0];
}

// åˆå§‹åŒ–æ¯æ—¥ä»»åŠ¡
async function initDailyTasks(openid) {
  // è¿™ä¸ªå‡½æ•°åœ¨ç”¨æˆ·é¦–æ¬¡ç™»å½•æ—¶è°ƒç”¨
  // å¯ä»¥é¢„è®¾ä¸€äº›åŸºç¡€ä»»åŠ¡
  const basicTasks = [
    {
      title: 'æ™¨é—´æ•£æ­¥',
      description: 'æ—©æ™¨æ•£æ­¥30åˆ†é’Ÿï¼Œå‘¼å¸æ–°é²œç©ºæ°”',
      category: 'exercise',
      type: 'daily',
      reward: 25,
      target_progress: 1
    },
    {
      title: 'å–æ°´æé†’',
      description: 'æ¯2å°æ—¶å–ä¸€æ¯æ°´ï¼Œä¿æŒèº«ä½“æ°´åˆ†',
      category: 'daily',
      type: 'daily',
      reward: 10,
      target_progress: 1
    }
    // æ›´å¤šåŸºç¡€ä»»åŠ¡...
  ];
  
  // æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å·²å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»º
  for (const task of basicTasks) {
    const existing = await db.collection('tasks')
      .where({ title: task.title })
      .get();
    
    if (existing.data.length === 0) {
      await db.collection('tasks').add({ data: task });
    }
  }
  
  return { success: true };
}
```

---

## ğŸ¾ ç¬¬å››é˜¶æ®µï¼šå® ç‰©ç®¡ç†ç³»ç»Ÿæ•°æ®åº“é›†æˆ

### 4.1 å® ç‰©ä¸»é¡µæ•°æ®åº“é›†æˆ

#### ä¿®æ”¹å® ç‰©ä¸»é¡µç›¸å…³æ–‡ä»¶
- [ ] **æ›´æ–°å® ç‰©ä¸»é¡µæ•°æ®åŠ è½½**
```javascript
// å‡è®¾å® ç‰©ä¸»é¡µåœ¨ pages/pet/pet.js
Page({
  data: {
    petInfo: null,
    loading: true,
    lastFeedTime: null,
    lastPlayTime: null,
    canFeed: true,
    canPlay: true
  },

  onLoad() {
    const app = getApp();
    if (!app.requireLogin()) {
      return;
    }
    this.loadPetData();
  },

  onShow() {
    this.loadPetData();
  },

  // åŠ è½½å® ç‰©æ•°æ®
  async loadPetData() {
    try {
      wx.showLoading({ title: 'åŠ è½½å® ç‰©ä¿¡æ¯...' });
      
      const result = await wx.cloud.callFunction({
        name: 'petManager',
        data: {
          action: 'getPetStatus'
        }
      });
      
      if (result.result.success) {
        const petData = result.result.data;
        this.setData({
          petInfo: petData.pet,
          lastFeedTime: petData.lastFeedTime,
          lastPlayTime: petData.lastPlayTime,
          canFeed: petData.canFeed,
          canPlay: petData.canPlay,
          loading: false
        });
        
        // æ›´æ–°æœ¬åœ°å­˜å‚¨
        wx.setStorageSync('petInfo', petData.pet);
      } else {
        throw new Error(result.result.error);
      }
    } catch (error) {
      console.error('åŠ è½½å® ç‰©æ•°æ®å¤±è´¥:', error);
      // ä½¿ç”¨æœ¬åœ°ç¼“å­˜æ•°æ®
      const localPetInfo = wx.getStorageSync('petInfo');
      if (localPetInfo) {
        this.setData({ 
          petInfo: localPetInfo,
          loading: false 
        });
      }
    } finally {
      wx.hideLoading();
    }
  },

  // å–‚é£ŸåŠŸèƒ½
  async feedPet() {
    if (!this.data.canFeed) {
      wx.showToast({
        title: 'å® ç‰©è¿˜ä¸é¥¿å“¦',
        icon: 'none'
      });
      return;
    }
    
    try {
      wx.showLoading({ title: 'å–‚é£Ÿä¸­...' });
      
      const result = await wx.cloud.callFunction({
        name: 'petManager',
        data: {
          action: 'feedPet'
        }
      });
      
      if (result.result.success) {
        const data = result.result.data;
        
        // æ˜¾ç¤ºå–‚é£Ÿæ•ˆæœ
        wx.showModal({
          title: 'å–‚é£ŸæˆåŠŸï¼',
          content: `å® ç‰©å¾ˆå¼€å¿ƒï¼å¥åº·å€¼ +${data.healthIncrease}`,
          showCancel: false
        });
        
        // åˆ·æ–°å® ç‰©æ•°æ®
        this.loadPetData();
        
        // è§¦å‘å–‚é£ŸåŠ¨ç”»
        this.playFeedAnimation();
      } else {
        throw new Error(result.result.error);
      }
    } catch (error) {
      console.error('å–‚é£Ÿå¤±è´¥:', error);
      wx.showToast({
        title: 'å–‚é£Ÿå¤±è´¥ï¼Œè¯·é‡è¯•',
        icon: 'none'
      });
    } finally {
      wx.hideLoading();
    }
  },

  // äº’åŠ¨åŠŸèƒ½
  async playWithPet() {
    if (!this.data.canPlay) {
      wx.showToast({
        title: 'å® ç‰©éœ€è¦ä¼‘æ¯ä¸€ä¸‹',
        icon: 'none'
      });
      return;
    }
    
    try {
      wx.showLoading({ title: 'äº’åŠ¨ä¸­...' });
      
      const result = await wx.cloud.callFunction({
        name: 'petManager',
        data: {
          action: 'playWithPet'
        }
      });
      
      if (result.result.success) {
        const data = result.result.data;
        
        wx.showModal({
          title: 'äº’åŠ¨æˆåŠŸï¼',
          content: `å® ç‰©å¾ˆå¿«ä¹ï¼äº²å¯†åº¦ +${data.intimacyIncrease}`,
          showCancel: false
        });
        
        this.loadPetData();
        this.playInteractionAnimation();
      } else {
        throw new Error(result.result.error);
      }
    } catch (error) {
      console.error('äº’åŠ¨å¤±è´¥:', error);
      wx.showToast({
        title: 'äº’åŠ¨å¤±è´¥ï¼Œè¯·é‡è¯•',
        icon: 'none'
      });
    } finally {
      wx.hideLoading();
    }
  },

  // æ’­æ”¾å–‚é£ŸåŠ¨ç”»
  playFeedAnimation() {
    // å®ç°å–‚é£ŸåŠ¨ç”»æ•ˆæœ
    this.setData({ showFeedEffect: true });
    setTimeout(() => {
      this.setData({ showFeedEffect: false });
    }, 2000);
  },

  // æ’­æ”¾äº’åŠ¨åŠ¨ç”»
  playInteractionAnimation() {
    // å®ç°äº’åŠ¨åŠ¨ç”»æ•ˆæœ
    this.setData({ showPlayEffect: true });
    setTimeout(() => {
      this.setData({ showPlayEffect: false });
    }, 2000);
  }
});
```

### 4.2 æ‰©å±• petManager äº‘å‡½æ•°

#### å®Œå–„ petManager/index.js
- [ ] **å®ç°å®Œæ•´çš„å® ç‰©ç®¡ç†åŠŸèƒ½**
```javascript
const cloud = require('wx-server-sdk');
cloud.init({ env: cloud.DYNAMIC_CURRENT_ENV });
const db = cloud.database();

exports.main = async (event, context) => {
  const wxContext = cloud.getWXContext();
  const openid = wxContext.OPENID;
  const { action } = event;
  
  try {
    switch (action) {
      case 'getPetStatus':
        return await getPetStatus(openid);
      case 'feedPet':
        return await feedPet(openid);
      case 'playWithPet':
        return await playWithPet(openid);
      case 'updatePetStatus':
        return await updatePetStatus(openid, event.updates);
      default:
        return { success: false, error: 'æ— æ•ˆçš„æ“ä½œç±»å‹' };
    }
  } catch (error) {
    console.error('petManageräº‘å‡½æ•°æ‰§è¡Œå¤±è´¥:', error);
    return {
      success: false,
      error: error.message
    };
  }
};

// è·å–å® ç‰©çŠ¶æ€
async function getPetStatus(openid) {
  const petQuery = await db.collection('pets')
    .where({ user_id: openid })
    .get();
  
  if (petQuery.data.length === 0) {
    throw new Error('å® ç‰©ä¿¡æ¯ä¸å­˜åœ¨');
  }
  
  const pet = petQuery.data[0];
  
  // è·å–æœ€è¿‘çš„äº’åŠ¨è®°å½•
  const today = new Date().toISOString().split('T')[0];
  const interactionQuery = await db.collection('pet_interactions')
    .where({
      user_id: openid,
      date: today
    })
    .orderBy('timestamp', 'desc')
    .get();
  
  // è®¡ç®—å†·å´æ—¶é—´
  const now = Date.now();
  const feedCooldown = 2 * 60 * 60 * 1000; // 2å°æ—¶
  const playCooldown = 1 * 60 * 60 * 1000; // 1å°æ—¶
  
  let lastFeedTime = null;
  let lastPlayTime = null;
  let canFeed = true;
  let canPlay = true;
  
  for (const interaction of interactionQuery.data) {
    const interactionTime = new Date(interaction.timestamp).getTime();
    
    if (interaction.type === 'feed' && !lastFeedTime) {
      lastFeedTime = interaction.timestamp;
      canFeed = (now - interactionTime) > feedCooldown;
    }
    
    if (interaction.type === 'play' && !lastPlayTime) {
      lastPlayTime = interaction.timestamp;
      canPlay = (now - interactionTime) > playCooldown;
    }
  }
  
  // è‡ªç„¶è¡°å‡å¤„ç†
  const updatedPet = await applyNaturalDecay(pet);
  
  return {
    success: true,
    data: {
      pet: updatedPet,
      lastFeedTime,
      lastPlayTime,
      canFeed,
      canPlay
    }
  };
}

// å–‚é£ŸåŠŸèƒ½
async function feedPet(openid) {
  // æ£€æŸ¥å†·å´æ—¶é—´
  const statusResult = await getPetStatus(openid);
  if (!statusResult.data.canFeed) {
    throw new Error('å® ç‰©è¿˜ä¸é¥¿ï¼Œè¯·ç¨åå†å–‚é£Ÿ');
  }
  
  const pet = statusResult.data.pet;
  
  // è®¡ç®—å±æ€§å¢åŠ 
  const healthIncrease = Math.min(15, 100 - pet.health);
  const intimacyIncrease = 3;
  
  // æ›´æ–°å® ç‰©çŠ¶æ€
  await db.collection('pets')
    .doc(pet._id)
    .update({
      data: {
        health: Math.min(pet.health + healthIncrease, 100),
        intimacy: Math.min(pet.intimacy + intimacyIncrease, 100),
        last_active: new Date()
      }
    });
  
  // è®°å½•äº’åŠ¨
  await db.collection('pet_interactions').add({
    data: {
      user_id: openid,
      pet_id: pet._id,
      type: 'feed',
      timestamp: new Date(),
      date: new Date().toISOString().split('T')[0],
      effect: {
        health: healthIncrease,
        intimacy: intimacyIncrease
      }
    }
  });
  
  return {
    success: true,
    data: {
      healthIncrease,
      intimacyIncrease
    }
  };
}

// äº’åŠ¨åŠŸèƒ½
async function playWithPet(openid) {
  const statusResult = await getPetStatus(openid);
  if (!statusResult.data.canPlay) {
    throw new Error('å® ç‰©éœ€è¦ä¼‘æ¯ï¼Œè¯·ç¨åå†äº’åŠ¨');
  }
  
  const pet = statusResult.data.pet;
  
  const vitalityIncrease = Math.min(10, 100 - pet.vitality);
  const intimacyIncrease = 5;
  const expIncrease = 2;
  
  // æ›´æ–°å® ç‰©çŠ¶æ€
  await db.collection('pets')
    .doc(pet._id)
    .update({
      data: {
        vitality: Math.min(pet.vitality + vitalityIncrease, 100),
        intimacy: Math.min(pet.intimacy + intimacyIncrease, 100),
        exp: pet.exp + expIncrease,
        last_active: new Date()
      }
    });
  
  // è®°å½•äº’åŠ¨
  await db.collection('pet_interactions').add({
    data: {
      user_id: openid,
      pet_id: pet._id,
      type: 'play',
      timestamp: new Date(),
      date: new Date().toISOString().split('T')[0],
      effect: {
        vitality: vitalityIncrease,
        intimacy: intimacyIncrease,
        exp: expIncrease
      }
    }
  });
  
  // æ£€æŸ¥æ˜¯å¦å‡çº§
  const newLevel = Math.floor((pet.exp + expIncrease) / 100) + 1;
  if (newLevel > pet.level) {
    await db.collection('pets')
      .doc(pet._id)
      .update({
        data: {
          level: newLevel
        }
      });
  }
  
  return {
    success: true,
    data: {
      vitalityIncrease,
      intimacyIncrease,
      expIncrease,
      levelUp: newLevel > pet.level
    }
  };
}

// è‡ªç„¶è¡°å‡å¤„ç†
async function applyNaturalDecay(pet) {
  const now = new Date();
  const lastActive = new Date(pet.last_active);
  const hoursSinceActive = (now - lastActive) / (1000 * 60 * 60);
  
  // æ¯å°æ—¶è¡°å‡1ç‚¹å¥åº·å€¼å’Œæ´»åŠ›å€¼
  const decayAmount = Math.floor(hoursSinceActive);
  
  if (decayAmount > 0) {
    const newHealth = Math.max(pet.health - decayAmount, 0);
    const newVitality = Math.max(pet.vitality - decayAmount, 0);
    
    if (newHealth !== pet.health || newVitality !== pet.vitality) {
      await db.collection('pets')
        .doc(pet._id)
        .update({
          data: {
            health: newHealth,
            vitality: newVitality
          }
        });
      
      return {
        ...pet,
        health: newHealth,
        vitality: newVitality
      };
    }
  }
  
  return pet;
}

// æ›´æ–°å® ç‰©çŠ¶æ€ï¼ˆé€šç”¨æ–¹æ³•ï¼‰
async function updatePetStatus(openid, updates) {
  const petQuery = await db.collection('pets')
    .where({ user_id: openid })
    .get();
  
  if (petQuery.data.length === 0) {
    throw new Error('å® ç‰©ä¿¡æ¯ä¸å­˜åœ¨');
  }
  
  const pet = petQuery.data[0];
  
  await db.collection('pets')
    .doc(pet._id)
    .update({
      data: {
        ...updates,
        last_active: new Date()
      }
    });
  
  return {
    success: true,
    data: {
      message: 'å® ç‰©çŠ¶æ€æ›´æ–°æˆåŠŸ'
    }
  };
}
```

---

## ğŸ”§ ç¬¬äº”é˜¶æ®µï¼šæ•°æ®åº“ä¼˜åŒ–å’Œç›‘æ§

### 5.1 æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–

#### åœ¨äº‘å¼€å‘æ§åˆ¶å°åˆ›å»ºç´¢å¼•
- [ ] **ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µåˆ›å»ºç´¢å¼•**
```javascript
// åœ¨äº‘å¼€å‘æ§åˆ¶å°çš„æ•°æ®åº“ç®¡ç†ä¸­åˆ›å»ºä»¥ä¸‹ç´¢å¼•ï¼š

// pet_users é›†åˆ
// ç´¢å¼•å­—æ®µï¼šuser_id (å‡åº)

// pets é›†åˆ  
// ç´¢å¼•å­—æ®µï¼šuser_id (å‡åº)

// chat_context é›†åˆ
// å¤åˆç´¢å¼•ï¼šuser_id (å‡åº), timestamp (é™åº)

// task_records é›†åˆ
// å¤åˆç´¢å¼•ï¼šuser_id (å‡åº), date (é™åº)
// å¤åˆç´¢å¼•ï¼šuser_id (å‡åº), task_id (å‡åº), date (é™åº)

// pet_interactions é›†åˆ
// å¤åˆç´¢å¼•ï¼šuser_id (å‡åº), date (é™åº), timestamp (é™åº)
```

### 5.2 é”™è¯¯ç›‘æ§å’Œæ—¥å¿—

#### åˆ›å»ºé€šç”¨é”™è¯¯å¤„ç†æ¨¡å—
- [ ] **åˆ›å»º utils/errorHandler.js**
```javascript
// miniprogram/utils/errorHandler.js
class ErrorHandler {
  static handleCloudFunctionError(error, functionName) {
    console.error(`äº‘å‡½æ•° ${functionName} è°ƒç”¨å¤±è´¥:`, error);
    
    // è®°å½•é”™è¯¯åˆ°äº‘æ•°æ®åº“ï¼ˆå¯é€‰ï¼‰
    this.logError({
      type: 'cloud_function',
      function_name: functionName,
      error_message: error.message,
      timestamp: new Date()
    });
    
    // è¿”å›ç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯
    if (error.message.includes('ç½‘ç»œ')) {
      return 'ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œåé‡è¯•';
    } else if (error.message.includes('æƒé™')) {
      return 'æƒé™ä¸è¶³ï¼Œè¯·é‡æ–°ç™»å½•';
    } else {
      return 'æ“ä½œå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•';
    }
  }
  
  static async logError(errorInfo) {
    try {
      await wx.cloud.callFunction({
        name: 'logError',
        data: errorInfo
      });
    } catch (e) {
      console.error('è®°å½•é”™è¯¯æ—¥å¿—å¤±è´¥:', e);
    }
  }
  
  static showUserFriendlyError(error, title = 'æ“ä½œå¤±è´¥') {
    const message = this.handleCloudFunctionError(error, 'unknown');
    wx.showModal({
      title,
      content: message,
      showCancel: false,
      confirmText: 'æˆ‘çŸ¥é“äº†'
    });
  }
}

module.exports = ErrorHandler;
```

### 5.3 æ€§èƒ½ç›‘æ§

#### åˆ›å»ºæ€§èƒ½ç›‘æ§äº‘å‡½æ•°
- [ ] **åˆ›å»º logError äº‘å‡½æ•°**
```javascript
// cloudfunctions/logError/index.js
const cloud = require('wx-server-sdk');
cloud.init({ env: cloud.DYNAMIC_CURRENT_ENV });
const db = cloud.database();

exports.main = async (event, context) => {
  const wxContext = cloud.getWXContext();
  
  try {
    await db.collection('error_logs').add({
      data: {
        ...event,
        user_id: wxContext.OPENID,
        timestamp: new Date()
      }
    });
    
    return { success: true };
  } catch (error) {
    console.error('è®°å½•é”™è¯¯æ—¥å¿—å¤±è´¥:', error);
    return { success: false, error: error.message };
  }
};
```

---

## ğŸ“Š ç¬¬å…­é˜¶æ®µï¼šæ•°æ®åˆ†æå’Œç»Ÿè®¡

### 6.1 ç”¨æˆ·è¡Œä¸ºåˆ†æ

#### åˆ›å»ºæ•°æ®åˆ†æäº‘å‡½æ•°
- [ ] **åˆ›å»º analytics äº‘å‡½æ•°**
```javascript
// cloudfunctions/analytics/index.js
const cloud = require('wx-server-sdk');
cloud.init({ env: cloud.DYNAMIC_CURRENT_ENV });
const db = cloud.database();

exports.main = async (event, context) => {
  const { action, timeRange = 7 } = event;
  
  try {
    switch (action) {
      case 'getUserStats':
        return await getUserStats(timeRange);
      case 'getTaskStats':
        return await getTaskStats(timeRange);
      case 'getPetStats':
        return await getPetStats(timeRange);
      default:
        return { success: false, error: 'æ— æ•ˆçš„åˆ†æç±»å‹' };
    }
  } catch (error) {
    console.error('æ•°æ®åˆ†æå¤±è´¥:', error);
    return { success: false, error: error.message };
  }
};

// ç”¨æˆ·ç»Ÿè®¡
async function getUserStats(days) {
  const startDate = new Date();
  startDate.setDate(startDate.getDate() - days);
  
  // æ´»è·ƒç”¨æˆ·ç»Ÿè®¡
  const activeUsers = await db.collection('pet_users')
    .where({
      last_login: db.command.gte(startDate)
    })
    .count();
  
  // æ–°ç”¨æˆ·ç»Ÿè®¡
  const newUsers = await db.collection('pet_users')
    .where({
      join_date: db.command.gte(startDate)
    })
    .count();
  
  return {
    success: true,
    data: {
      activeUsers: activeUsers.total,
      newUsers: newUsers.total,
      timeRange: days
    }
  };
}

// ä»»åŠ¡ç»Ÿè®¡
async function getTaskStats(days) {
  const startDate = new Date();
  startDate.setDate(startDate.getDate() - days);
  const startDateStr = startDate.toISOString().split('T')[0];
  
  // ä»»åŠ¡å®Œæˆç»Ÿè®¡
  const completedTasks = await db.collection('task_records')
    .where({
      date: db.command.gte(startDateStr)
    })
    .count();
  
  // æŒ‰ç±»åˆ«ç»Ÿè®¡
  const tasksByCategory = await db.collection('task_records')
    .aggregate()
    .match({
      date: db.command.gte(startDateStr)
    })
    .lookup({
      from: 'tasks',
      localField: 'task_id',
      foreignField: '_id',
      as: 'task_info'
    })
    .group({
      _id: '$task_info.category',
      count: db.command.sum(1)
    })
    .end();
  
  return {
    success: true,
    data: {
      totalCompleted: completedTasks.total,
      byCategory: tasksByCategory.list,
      timeRange: days
    }
  };
}

// å® ç‰©ç»Ÿè®¡
async function getPetStats(days) {
  const startDate = new Date();
  startDate.setDate(startDate.getDate() - days);
  
  // å® ç‰©äº’åŠ¨ç»Ÿè®¡
  const interactions = await db.collection('pet_interactions')
    .where({
      timestamp: db.command.gte(startDate)
    })
    .count();
  
  // å¹³å‡å® ç‰©ç­‰çº§
  const avgLevel = await db.collection('pets')
    .aggregate()
    .group({
      _id: null,
      avgLevel: db.command.avg('$level'),
      avgHealth: db.command.avg('$health'),
      avgIntimacy: db.command.avg('$intimacy')
    })
    .end();
  
  return {
    success: true,
    data: {
      totalInteractions: interactions.total,
      averageStats: avgLevel.list[0] || {},
      timeRange: days
    }
  };
}
```

---

## ğŸš€ éƒ¨ç½²å’Œæµ‹è¯•æŒ‡å—

### éƒ¨ç½²æ­¥éª¤

1. **äº‘å‡½æ•°éƒ¨ç½²**
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
./deploy-cloudfunctions.sh
```

2. **æ•°æ®åº“åˆå§‹åŒ–**
```bash
# è¿è¡Œæ•°æ®åº“åˆå§‹åŒ–
node call-init-database.js
```

3. **åˆ›å»ºæ•°æ®åº“ç´¢å¼•**
   - ç™»å½•äº‘å¼€å‘æ§åˆ¶å°
   - åœ¨æ•°æ®åº“ç®¡ç†ä¸­ä¸ºå„é›†åˆåˆ›å»ºç´¢å¼•

### æµ‹è¯•æ¸…å•

- [ ] ç”¨æˆ·ç™»å½•åŠŸèƒ½æµ‹è¯•
- [ ] èŠå¤©å†å²åŠ è½½æµ‹è¯•
- [ ] ä»»åŠ¡å®Œæˆå’Œå¥–åŠ±æµ‹è¯•
- [ ] å® ç‰©å–‚é£Ÿå’Œäº’åŠ¨æµ‹è¯•
- [ ] æ•°æ®åŒæ­¥æµ‹è¯•
- [ ] é”™è¯¯å¤„ç†æµ‹è¯•

### ç›‘æ§æŒ‡æ ‡

- ç”¨æˆ·æ´»è·ƒåº¦
- ä»»åŠ¡å®Œæˆç‡
- å® ç‰©äº’åŠ¨é¢‘ç‡
- äº‘å‡½æ•°è°ƒç”¨æˆåŠŸç‡
- æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®å®‰å…¨**ï¼šç¡®ä¿æ‰€æœ‰ç”¨æˆ·æ•°æ®æŸ¥è¯¢éƒ½åŒ…å«ç”¨æˆ·IDè¿‡æ»¤
2. **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆç†ä½¿ç”¨æ•°æ®åº“ç´¢å¼•ï¼Œé¿å…å…¨è¡¨æ‰«æ
3. **é”™è¯¯å¤„ç†**ï¼šä¸ºæ‰€æœ‰äº‘å‡½æ•°è°ƒç”¨æ·»åŠ é”™è¯¯å¤„ç†
4. **ç”¨æˆ·ä½“éªŒ**ï¼šæä¾›åŠ è½½çŠ¶æ€å’Œå‹å¥½çš„é”™è¯¯æç¤º
5. **æ•°æ®ä¸€è‡´æ€§**ï¼šä½¿ç”¨äº‹åŠ¡å¤„ç†å…³é”®æ“ä½œ

---

## ğŸ”„ åç»­ä¼˜åŒ–æ–¹å‘

1. **å®æ—¶æ•°æ®åŒæ­¥**ï¼šä½¿ç”¨äº‘å¼€å‘çš„å®æ—¶æ•°æ®åº“åŠŸèƒ½
2. **ç¦»çº¿æ”¯æŒ**ï¼šå®ç°ç¦»çº¿æ•°æ®ç¼“å­˜å’ŒåŒæ­¥
3. **æ¨é€é€šçŸ¥**ï¼šæ·»åŠ ä»»åŠ¡æé†’å’Œå® ç‰©çŠ¶æ€é€šçŸ¥
4. **ç¤¾äº¤åŠŸèƒ½**ï¼šå¥½å‹ç³»ç»Ÿå’Œæ’è¡Œæ¦œ
5. **AIå¢å¼º**ï¼šæ›´æ™ºèƒ½çš„ä»»åŠ¡æ¨èå’Œå® ç‰©äº’åŠ¨

---

*æœ€åæ›´æ–°æ—¶é—´ï¼š2024å¹´1æœˆ*