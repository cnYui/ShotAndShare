<!-- 个人设置页面 -->
<view class="profile-container {{themeClass}}">
  <!-- 用户信息卡片 -->
  <view class="user-card">
    <view class="user-avatar">
      <image src="{{userInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill" />
      <view class="avatar-edit" bindtap="editAvatar">
        <image src="/images/icon-camera.png" />
      </view>
    </view>
    <view class="user-info">
      <view class="user-name">{{userInfo.name || texts.profile.userInfo.setNickname}}</view>
      <view class="user-level">Lv.{{userInfo.level}} · {{userInfo.title}}</view>
      <view class="user-stats">
        <view class="stat-item">
          <text class="stat-value">{{userInfo.totalDays}}</text>
          <text class="stat-label">{{texts.profile.userInfo.totalDays}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-value">{{userInfo.totalTasks}}</text>
          <text class="stat-label">{{texts.profile.userInfo.totalTasks}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-value">{{userInfo.totalExp}}</text>
          <text class="stat-label">{{texts.profile.userInfo.totalExp}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 宠物信息 -->
  <view class="pet-section">
    <view class="section-title">
      <image src="/images/icon-pet.png" class="title-icon" />
      <text>{{texts.profile.pet.title}}</text>
    </view>
    <view class="pet-card" bindtap="editPet">
      <view class="pet-avatar">
        <image src="{{petInfo.avatar}}" mode="aspectFill" />
      </view>
      <view class="pet-info">
        <view class="pet-name">{{petInfo.name}}</view>
        <view class="pet-level">Lv.{{petInfo.level}} · {{petInfo.type}}</view>
        <view class="pet-mood">{{texts.profile.pet.mood}}{{petInfo.mood}}</view>
      </view>
      <view class="arrow-right">
        <image src="/images/icon-arrow-right.png" />
      </view>
    </view>
  </view>

  <!-- 设置选项 -->
  <view class="settings-section">
    <view class="section-title">
      <image src="/images/icon-settings.png" class="title-icon" />
      <text>{{texts.profile.settings.title}}</text>
    </view>
    
    <!-- 通知设置 -->
    <view class="setting-group">
      <view class="group-title">{{texts.profile.settings.notification.title}}</view>
      <view class="setting-item">
        <view class="item-left">
          <image src="/images/icon-notification.png" class="item-icon" />
          <text class="item-title">{{texts.profile.settings.notification.taskReminder}}</text>
        </view>
        <switch checked="{{settings.taskNotification}}" bindchange="onTaskNotificationChange" color="#A3D39C" />
      </view>
      <view class="setting-item">
        <view class="item-left">
          <image src="/images/icon-water.png" class="item-icon" />
          <text class="item-title">{{texts.profile.settings.notification.waterReminder}}</text>
        </view>
        <switch checked="{{settings.waterReminder}}" bindchange="onWaterReminderChange" color="#A3D39C" />
      </view>
      <view class="setting-item">
        <view class="item-left">
          <image src="/images/icon-sleep.png" class="item-icon" />
          <text class="item-title">{{texts.profile.settings.notification.sleepReminder}}</text>
        </view>
        <switch checked="{{settings.sleepReminder}}" bindchange="onSleepReminderChange" color="#A3D39C" />
      </view>
    </view>

    <!-- 隐私设置 -->
    <view class="setting-group">
      <view class="group-title">{{texts.profile.settings.privacy.title}}</view>
      <view class="setting-item">
        <view class="item-left">
          <image src="/images/icon-data.png" class="item-icon" />
          <text class="item-title">{{texts.profile.settings.privacy.dataSync}}</text>
        </view>
        <switch checked="{{settings.dataSync}}" bindchange="onDataSyncChange" color="#A3D39C" />
      </view>
      <view class="setting-item" bindtap="openPrivacyPolicy">
        <view class="item-left">
          <image src="/images/icon-privacy.png" class="item-icon" />
          <text class="item-title">{{texts.profile.settings.privacy.privacyPolicy}}</text>
        </view>
        <view class="arrow-right">
          <image src="/images/icon-arrow-right.png" />
        </view>
      </view>
    </view>

    <!-- 应用设置 -->
    <view class="setting-group">
      <view class="group-title">{{texts.profile.settings.app.title}}</view>
      <view class="setting-item" bindtap="openThemeSettings">
        <view class="item-left">
          <image src="/images/icon-theme.png" class="item-icon" />
          <text class="item-title">{{texts.profile.settings.app.theme}}</text>
        </view>
        <view class="item-right">
          <text class="item-value">{{settings.theme}}</text>
          <view class="arrow-right">
            <image src="/images/icon-arrow-right.png" />
          </view>
        </view>
      </view>
      <view class="setting-item" bindtap="openLanguageSettings">
        <view class="item-left">
          <image src="/images/icon-language.png" class="item-icon" />
          <text class="item-title">{{texts.profile.settings.app.language}}</text>
        </view>
        <view class="item-right">
          <text class="item-value">{{settings.language}}</text>
          <view class="arrow-right">
            <image src="/images/icon-arrow-right.png" />
          </view>
        </view>
      </view>
      <view class="setting-item" bindtap="clearCache">
        <view class="item-left">
          <image src="/images/icon-cache.png" class="item-icon" />
          <text class="item-title">{{texts.profile.settings.app.clearCache}}</text>
        </view>
        <view class="item-right">
          <text class="item-value">{{cacheSize}}</text>
          <view class="arrow-right">
            <image src="/images/icon-arrow-right.png" />
          </view>
        </view>
      </view>
    </view>

    <!-- 关于应用 -->
    <view class="setting-group">
      <view class="group-title">{{texts.profile.settings.about.title}}</view>
      <view class="setting-item" bindtap="checkUpdate">
        <view class="item-left">
          <image src="/images/icon-update.png" class="item-icon" />
          <text class="item-title">{{texts.profile.settings.about.checkUpdate}}</text>
        </view>
        <view class="item-right">
          <text class="item-value">v{{appVersion}}</text>
          <view class="arrow-right">
            <image src="/images/icon-arrow-right.png" />
          </view>
        </view>
      </view>
      <view class="setting-item" bindtap="openAbout">
        <view class="item-left">
          <image src="/images/icon-about.png" class="item-icon" />
          <text class="item-title">{{texts.profile.settings.about.aboutUs}}</text>
        </view>
        <view class="arrow-right">
          <image src="/images/icon-arrow-right.png" />
        </view>
      </view>
      <view class="setting-item" bindtap="openFeedback">
        <view class="item-left">
          <image src="/images/icon-feedback.png" class="item-icon" />
          <text class="item-title">{{texts.profile.settings.about.feedback}}</text>
        </view>
        <view class="arrow-right">
          <image src="/images/icon-arrow-right.png" />
        </view>
      </view>
    </view>
  </view>

  <!-- 退出登录 -->
  <view class="logout-section">
    <button class="logout-btn" bindtap="logout">{{texts.profile.logout.title}}</button>
  </view>
</view>

<!-- 编辑用户信息弹窗 -->
<view class="edit-modal" wx:if="{{showEditModal}}">
  <view class="modal-mask" bindtap="hideEditModal"></view>
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">{{texts.profile.userInfo.editProfile}}</text>
      <button class="modal-close" bindtap="hideEditModal">
        <image src="/images/icon-close.png" />
      </button>
    </view>
    <view class="modal-body">
      <view class="input-group">
        <text class="input-label">{{texts.profile.userInfo.nickname}}</text>
        <input class="user-input" value="{{editUserInfo.name}}" placeholder="{{texts.profile.userInfo.nicknamePlaceholder}}" bindinput="onNameInput" />
      </view>
      <view class="input-group">
        <text class="input-label">{{texts.profile.userInfo.signature}}</text>
        <textarea class="user-textarea" value="{{editUserInfo.signature}}" placeholder="{{texts.profile.userInfo.signaturePlaceholder}}" bindinput="onSignatureInput" maxlength="50"></textarea>
      </view>
    </view>
    <view class="modal-footer">
      <button class="modal-btn cancel" bindtap="hideEditModal">{{texts.common.cancel}}</button>
      <button class="modal-btn confirm" bindtap="confirmEdit">{{texts.common.confirm}}</button>
    </view>
  </view>
</view>